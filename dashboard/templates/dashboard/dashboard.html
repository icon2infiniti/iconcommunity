{% extends 'base.html' %}
{% load static i18n %}
{% load humanize %}
{% block extra_head %}
  <link href="{% static 'dashboard/css/dashboard.css' %}" rel="stylesheet"/>
  <script>
      // Daily Tx
      var chartlabels = {{ targetDates|safe }};
      var chartdata = {{ txCounts }};
      // Top 20 Wallets
      var ret20 = {{ ret20|safe }};
      // Wallet Count
      var selectDates = {{ selectDates|safe }};
      var balanceCounts = {{ balanceCounts }};
      var totalCounts = {{ totalCounts }};
      // Reward Rate
      var annual_real_yield_list = {{ annual_real_yield_list }};
      var annual_reward_list = {{ annual_reward_list }};
      var annual_inflation_list = {{ annual_inflation_list }};
      var reward_rate_dates_list = {{ reward_rate_dates_list|safe }};
  </script>
{% endblock %}
{% block title %}Dashboard{% endblock %}
{% block ogtitle %}Dashboard{% endblock %}
{% block twittertitle %}Dashboard{% endblock %}
{% block section %}Dashboard{% endblock %}
{% block content %}
  {% load mathfilters %}

  <!-- Daily transactions -->
  <div class="row">
    <div class="col-12">
      <div class="card card-chart">
        <div class="card-header">
          <div class="row">
            <div class="col-sm-6 text-left">
              <h2 class="card-title">{% trans 'Daily Transactions' %}</h2>
              <h5>24H Transactions: {{ transactions_24h|intcomma }}
                <span class="spacing">&vert;</span> All Transactions: {{ transactions_all|intcomma }}</h5>
            </div>
            <!-- Sort Buttons -->
            <div class="col-sm-6">
              <div class="btn-group btn-group-toggle float-right" data-toggle="buttons">
                <label class="btn btn-sm btn-primary btn-simple" id="0">
                  <input type="radio" name="options">
                  <span class="d-none d-sm-block d-md-block d-lg-block d-xl-block">7D</span>
                  <span class="d-block d-sm-none">
                    7D
                  </span>
                </label>
                <label class="btn btn-sm btn-primary btn-simple" id="1">
                  <input type="radio" class="d-none d-sm-none" name="options">
                  <span class="d-none d-sm-block d-md-block d-lg-block d-xl-block">14D</span>
                  <span class="d-block d-sm-none">
                    14D
                  </span>
                </label>
                <label class="btn btn-sm btn-primary btn-simple active" id="2">
                  <input type="radio" class="d-none" name="options" checked>
                  <span class="d-none d-sm-block d-md-block d-lg-block d-xl-block">30D</span>
                  <span class="d-block d-sm-none">
                    30D
                  </span>
                </label>
              </div>
            </div>
          </div>
        </div>
        <div class="card-body">
          <div class="chart-area">
            <canvas id="dailyTx"></canvas>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Info -->
  <div class="row">
    <!-- Market Cap -->
    <div class="col-lg-3 col-md-6">
      <div class="card card-stats">
        <div class="card-body">
          <div class="row">
            <div class="col-4">
              <div class="info-icon text-center dollar">
                <i class="fas fa-dollar-sign"></i>
              </div>
            </div>
            <div class="col-8">
              <div class="numbers">
                <p class="card-category">{% trans 'Market Cap (USD)' %}</p>
                <h3 class="card-title">{{ marketcap|floatformat:0|intcomma }}</h3>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Circulating Supply -->
    <div class="col-lg-3 col-md-6">
      <div class="card card-stats">
        <div class="card-body">
          <div class="row">
            <div class="col-4">
              <div class="info-icon text-center icon-primary">
                <img src="{% static 'dashboard/img/ICX_logo.png' %}" style="width: 24px; height: 24px; margin-top: 13px;">
              </div>
            </div>
            <div class="col-8">
              <div class="numbers">
                <p class="card-category">{% trans 'Circulating Supply' %}</p>
                <h3 class="card-title">{{ circulating_supply|floatformat:0|intcomma }}</h3>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Total Supply -->
    <div class="col-lg-3 col-md-6">
      <div class="card card-stats">
        <div class="card-body">
          <div class="row">
            <div class="col-4">
              <div class="info-icon text-center icon-primary">
                <img src="{% static 'dashboard/img/ICX_logo.png' %}" style="width: 24px; height: 24px; margin-top: 13px;">
              </div>
            </div>
            <div class="col-8">
              <div class="numbers">
                <p class="card-category">{% trans 'Total Supply' %}</p>
                <h3 class="card-title">{{ total_supply|floatformat:0|intcomma }}</h3>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Public Treasury -->
    <div class="col-lg-3 col-md-6">
      <div class="card card-stats">
        <div class="card-body">
          <div class="row">
            <div class="col-4">
              <div class="info-icon text-center dollargreen">
                <i class="fas fa-dollar-sign"></i>
              </div>
            </div>
            <div class="col-8">
              <div class="numbers">
                <p class="card-category">{% trans 'Public Treasury' %}&nbsp; <i class="fas fa-info-circle tip" data-toggle="tooltip" title="Unclaimed ICX from additional issuance."></i></p>
                <h3 class="card-title">{{ public_treasury|floatformat:0|intcomma }}</h3>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- RR & WC -->
  <div class="row">
    <!-- Reward Rate -->
    <div class="col-lg-6">
      <div class="card card-chart">

        <div class="card-header">
          <div class="row">
            <div class="col-sm-6 text-left">
              <h2 class="card-title" style="margin-bottom: 0px;">{% trans 'Real Yield' %}</h2>
              <h5 class="card-category">Reward Rate - Inflation Rate</h5>
            </div>
            <!-- Sort Buttons -->
            <div class="col-sm-6">
              <div class="btn-group btn-group-toggle float-right" data-toggle="buttons">
                <label class="btn btn-sm btn-primary btn-simple" id="rr0">
                  <input type="radio" name="options">
                  <span class="d-none d-sm-block d-md-block d-lg-block d-xl-block">7D</span>
                  <span class="d-block d-sm-none">
                    7D
                  </span>
                </label>
                <label class="btn btn-sm btn-primary btn-simple" id="rr1">
                  <input type="radio" class="d-none d-sm-none" name="options">
                  <span class="d-none d-sm-block d-md-block d-lg-block d-xl-block">14D</span>
                  <span class="d-block d-sm-none">
                    14D
                  </span>
                </label>
                <label class="btn btn-sm btn-primary btn-simple active" id="rr2">
                  <input type="radio" class="d-none" name="options" checked>
                  <span class="d-none d-sm-block d-md-block d-lg-block d-xl-block">All</span>
                  <span class="d-block d-sm-none">
                    All
                  </span>
                </label>
              </div>
            </div>
          </div>
        </div>

        <div class="card-body">
          <div class="chart-area">
            <div class="chartjs-size-monitor">
              <div class="chartjs-size-monitor-expand">
                <div class=""></div>
              </div>
              <div class="chartjs-size-monitor-shrink">
                <div class=""></div>
              </div>
            </div>
            <canvas id="RewardRate" class="chartjs-render-monitor" style="display: block;"></canvas>
          </div>
        </div>

      </div>
    </div>

    <!-- Wallet Count -->
    <div class="col-lg-6">
      <div class="card card-chart">
        <div class="card-header">
          <div class="row">
            <div class="col-sm-6 text-left">
              <h2 class="card-title" style="margin-bottom: 0px;">{% trans 'Wallet Count' %}</h2>
              <h5 class="card-category">Cumulative data</h5>
            </div>
            <!-- Sort Buttons -->
            <div class="col-sm-6">
              <div class="btn-group btn-group-toggle float-right" data-toggle="buttons">
                <label class="btn btn-sm btn-primary btn-simple" id="wc0">
                  <input type="radio" name="options">
                  <span class="d-none d-sm-block d-md-block d-lg-block d-xl-block">7D</span>
                  <span class="d-block d-sm-none">
                    7D
                  </span>
                </label>
                <label class="btn btn-sm btn-primary btn-simple" id="wc1">
                  <input type="radio" class="d-none d-sm-none" name="options">
                  <span class="d-none d-sm-block d-md-block d-lg-block d-xl-block">14D</span>
                  <span class="d-block d-sm-none">
                    14D
                  </span>
                </label>
                <label class="btn btn-sm btn-primary btn-simple active" id="wc2">
                  <input type="radio" class="d-none" name="options" checked>
                  <span class="d-none d-sm-block d-md-block d-lg-block d-xl-block">All</span>
                  <span class="d-block d-sm-none">
                    All
                  </span>
                </label>
              </div>
            </div>
          </div>

        </div>
        <div class="card-body">
          <div class="chart-area">
            <div class="chartjs-size-monitor">
              <div class="chartjs-size-monitor-expand">
                <div class=""></div>
              </div>
              <div class="chartjs-size-monitor-shrink">
                <div class=""></div>
              </div>
            </div>
            <canvas id="WalletCountChart" class="chartjs-render-monitor" style="display: block;"></canvas>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Top Wallets -->
  <div class="row">
    <div class="col-md-12 ml-auto">
      <div class="card card-chart card-chart-pie">
        <div class="card-header">
          <h2 class="card-title">ICX Holder Chart</h2>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-12">
              <div class="chart-area">
                <div id="top20wallets"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bar/Curve charts -->
  <!--
  <div class="col-lg-4">
    <div class="card card-chart">
      <div class="card-header">
        <h5 class="card-category">Some Curves</h5>
        <h3 class="card-title"><i class="tim-icons icon-bell-55 text-primary"></i> 763,215</h3>
      </div>
      <div class="card-body">
        <div class="chart-area">
          <canvas id="chartLinePurple"></canvas>
        </div>
      </div>
    </div>
  </div>
  <div class="col-lg-4">
    <div class="card card-chart">
      <div class="card-header">
        <h5 class="card-category">Some Bars</h5>
        <h3 class="card-title"><i class="tim-icons icon-delivery-fast text-info"></i> 3,500</h3>
      </div>
      <div class="card-body">
        <div class="chart-area">
          <canvas id="CountryChart"></canvas>
        </div>
      </div>
    </div>
  </div>
  <div class="col-lg-4">
    <div class="card card-chart">
      <div class="card-header">
        <h5 class="card-category">Some More Curves</h5>
        <h3 class="card-title"><i class="tim-icons icon-send text-success"></i> 12,100</h3>
      </div>
      <div class="card-body">
        <div class="chart-area">
          <canvas id="chartLineGreen"></canvas>
        </div>
      </div>
    </div>
  </div>
  -->

  <!-- ICX Price -->
  <!--
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-header">
          <div class="row">
            <div class="col-sm-6 text-left"><h2 class="card-title">{% trans 'ICX Price' %}</h2></div>
            <div class="col-sm-6 rate">
              <div class="btn-group btn-group-toggle float-right currency" data-toggle="buttons">
                <label class="btn btn-sm btn-primary btn-simple active" id="0">
                  <input type="radio" name="options" checked>
                  <span class="d-none d-sm-block d-md-block d-lg-block d-xl-block" onclick="toggleCurrency('BTC');">BTC</span>
                  <span class="d-block d-sm-none" onclick="toggleCurrency('BTC');">BTC</span>
                </label>
                <label class="btn btn-sm btn-primary btn-simple" id="1">
                  <input type="radio" class="d-none d-sm-none" name="options">
                  <span class="d-none d-sm-block d-md-block d-lg-block d-xl-block" onclick="toggleCurrency('ETH');">ETH</span>
                  <span class="d-block d-sm-none" onclick="toggleCurrency('ETH');">ETH</span>
                </label>
                <label class="btn btn-sm btn-primary btn-simple" id="2">
                  <input type="radio" class="d-none" name="options">
                  <span class="d-none d-sm-block d-md-block d-lg-block d-xl-block" onclick="toggleCurrency('USD');">USD</span>
                  <span class="d-block d-sm-none" onclick="toggleCurrency('USD');">USD</span>
                </label>
              </div>
            </div>
          </div>
        </div>
        <div class="card-body">
          <div class="part rates">

            <p class="icx-group">
              <span class="icx">1<em>ICX</em></span> <span class="same">=</span>
              <span class="eth" id="eth">0<em>BTC</em></span>
            </p>

            <ul class="content half market-vol-wrap">
              <li class="left">
                <p class="subTitle">{% trans 'Market Cap' %}</p>
                <p><em>B</em>0<em>K</em></p>
              </li>
              <li class="right">
                <p class="subTitle">{% trans 'Volume' %}</p>
                <p><em>B</em>0</p>
              </li>
            </ul>
          </div>
        </div>


      </div>
    </div>
  </div>
  -->

  <!-- ICX Market Chart -->
  <!--
  <div class="row">
    <div class="col-12">
      <div class="card card-chart">
        <div class="card-header">
          <div class="row">
            <div class="col-sm-6 text-left">
              <h2 class="card-title">{% trans 'ICX Chart' %}</h2>
            </div>
            <div class="col-sm-6 duration">
              <div class="btn-group btn-group-toggle float-right" data-toggle="buttons">
                <label class="btn btn-sm btn-primary btn-simple active" id="0">
                  <input type="radio" name="options" checked>
                  <span class="d-none d-sm-block d-md-block d-lg-block d-xl-block" onclick="toggleDuration('DAY');">{% trans 'Day' %}</span>
                  <span class="d-block d-sm-none" onclick="toggleDuration('DAY');">24H</span>
                </label>
                <label class="btn btn-sm btn-primary btn-simple" id="1">
                  <input type="radio" class="d-none d-sm-none" name="options">
                  <span class="d-none d-sm-block d-md-block d-lg-block d-xl-block" onclick="toggleDuration('WEEK');">{% trans 'Week' %}</span>
                  <span class="d-block d-sm-none" onclick="toggleDuration('WEEK');">7D</span>
                </label>
                <label class="btn btn-sm btn-primary btn-simple" id="2">
                  <input type="radio" class="d-none" name="options">
                  <span class="d-none d-sm-block d-md-block d-lg-block d-xl-block" onclick="toggleDuration('MONTH');">{% trans 'Month' %}</span>
                  <span class="d-block d-sm-none" onclick="toggleDuration('MONTH');">30D</span>
                </label>
              </div>
            </div>
          </div>
        </div>
        <div class="card-body">
						<div class="chart">
						  <canvas class="chartCanvas" id="chartCanvas"></canvas>
						</div>
        </div>
      </div>
    </div>
  </div>
  -->

  <!-- DAPPs Market Cap -->
  <!--
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">{% trans 'Dapps Market Cap' %}</h2>
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-typeI">
              <thead class="text-primary">
              <tr>
                <th class="text-center">#</th>
                <th>{% trans 'Token' %}</th>
                <th>{% trans 'Price (ICX)' %}</th>
                <th>{% trans '% Change (24h)' %}</th>
                <th>{% trans 'Volume (24h)' %}</th>
                <th>{% trans 'Market Cap (ICX)' %}</th>
              </tr>
              </thead>
              <tbody>

              <tr>
                <td class="text-center">
                  <div class="photo">
                    <img src="{% static 'dashboard/img/ac3.jpg' %}" alt="photo">
                  </div>
                </td>
                <td>AC3 (AC3)</td>
                <td>{{ ac3data.quote.ICX.price|floatformat:"5" }} ICX</td>
                <td id="ac3_change"><span class="rekt">{{ ac3data.quote.ICX.percent_change_24h }}</span></td>
                <td id="ac3_volume">{{ ac3data.quote.ICX.volume_24h|floatformat:0 }}</td>
                <td id="ac3_market_cap">{{ ac3data.quote.ICX.market_cap|floatformat:0 }} </td>
              </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
  -->

{% endblock %}

{% block pre_extra_js %}
  <script>
      function morning_image() {
      }

      function night_image() {
      }
  </script>
{% endblock %}

{% block extra_js %}

  <script src="{% static 'dashboard/js/chart.bundle.min.js' %}"></script>
  <!--
  <script src="{% static 'dashboard/js/coininfo.js' %}"></script>
  <script src="{% static 'dashboard/js/jquery-jvectormap.js' %}"></script>
  -->
  <script src="{% static 'dashboard/js/dashboard.js' %}"></script>

  <script src="{% static 'el-pagination/js/el-pagination.js' %}"></script>

  <script src="https://code.highcharts.com/highcharts.js"></script>

  <script>
      $(document).ready(function () {
          charts.initDashboardPageCharts(chartlabels, chartdata);

          charts.initWalletCharts(ret20);

          charts.initWalletCountChart(selectDates, balanceCounts, totalCounts);

          charts.initRewardRateChart(annual_inflation_list, annual_reward_list, annual_real_yield_list, reward_rate_dates_list);

          $('[data-toggle="tooltip"]').tooltip();

          <!--mapobj.initVectorMap(countries_alpha2);-->
          <!--
          var ac3_market_cap = parseFloat($('#ac3_market_cap').text()).toLocaleString();
          var ac3_volume = parseFloat($('#ac3_volume').text()).toLocaleString();
          var ac3_change = parseFloat($('#ac3_change > span').text());

          if (ac3_change > 0) {
              $('#ac3_change > span').addClass('moon');
          } else {
              $('#ac3_change > span').addClass('rekt');
          }

          $('#ac3_market_cap').text(ac3_market_cap+" ICX");
          $('#ac3_volume').text(ac3_volume+" ICX");
          $('#ac3_change > span').text(ac3_change+" %");
          -->
      });
  </script>


  <script>
      $.endlessPaginate({
          contentSelector: '.endless_content_wrapper'
      });

      /* CALCULATOR
      function rrep(delrate){
        const r_min = 0.02, r_max = 0.12, r_point = 0.7;
        return ((r_max-r_min)/(r_point**2)) * ((delrate/100)-r_point)**2 + r_min;
      }
      */

  </script>

{% endblock %}